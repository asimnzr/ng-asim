<div class='md-padding' data-ng-init="vm.getReceiveDevice()" style="max-height:490px; overflow-y:auto">
	<div layout="row">
		<div class="md-title"><span><md-icon class="md-warn">perm_device_information</md-icon> Edit Receive Device</span></div>
	</div>
	<hr class="hr-bottom">
	<div layout="row" class="md-headline" data-ng-if="vm.ErrorMessage">
		<div flex="90" class="md-warn md-hue1"> {{::vm.ErrorMessage}}</div>
		<div flex="5">
			<md-button class="md-warn md-mini md-fab" data-ng-click="vm.ErrorMessage=''">
				<md-icon>cancel</md-icon>
				<md-tooltip>Remove</md-tooltip>
			</md-button>
		</div>
	</div>
	<div>
		<form name="receiveDeviceForm">
			<div layout="row">
				<div flex="5">
					<md-icon style="color: dodgerblue; margin-top: 25px;">person</md-icon>
				</div>
				<div flex="25">
					<md-autocomplete md-input-minlength="2" md-no-cache="true" md-selected-item="vm.receiveDevice.Customer" md-search-text="vm.receiveDevice.search.customerQuery"
						md-items="customer in vm.searchCustomers(vm.receiveDevice.search.customerQuery)" md-item-text="customer.name" md-floating-label="Search Customer"
						data-ng-readonly="!$state.includes('editreceivedevice')">
						<md-item-template>
							<span md-highlight-text="vm.receiveDevice.search.customerQuery">{{customer.name}}</span>
						</md-item-template>
						<md-not-found>
							No customers found.
						</md-not-found>
					</md-autocomplete>
				</div>
				<div flex="5">
					<!-- Spacer //-->
				</div>
				<div flex="20" data-ng-if="vm.receiveDevice.Customer">
					<md-input-container class="md-block">
						<label>Email</label>
						<input name="email" ng-model="vm.receiveDevice.Customer.email" disabled />
					</md-input-container>
				</div>
				<div flex="5">
					<!-- Spacer //-->
				</div>
				<div flex="30" data-ng-if="vm.receiveDevice.Customer">
					<md-input-container class="md-block">
						<label>Address</label>
						<input name="address" ng-model="vm.receiveDevice.Customer.address" disabled />
					</md-input-container>
				</div>
			</div>
			<div layout="row">
				<div flex="5">
					<md-icon style="color: green; margin-top: 25px;">tv</md-icon>
				</div>
				<div flex="25">
					<md-autocomplete md-input-minlength="2" md-no-cache="true" md-selected-item="vm.receiveDevice.Device" md-search-text="deviceQuery"
						md-items="device in vm.searchDevices(deviceQuery)" md-item-text="device.DeviceType.name + ' ' + device.brand + ' ' + device.series + ' ' + device.model"
						md-floating-label="Search Device" data-ng-readonly="!$state.includes('editreceivedevice')">
						<md-item-template>
							<span md-highlight-text="deviceQuery">{{::device.DeviceType.name}} {{::device.brand}} {{::device.series}} {{::device.model}}</span>
						</md-item-template>
						<md-not-found>
							No devices found.
						</md-not-found>
					</md-autocomplete>
				</div>
				<div flex="5">
					<!-- Spacer //-->
				</div>
				<div flex="20">
					<md-autocomplete md-input-minlength="2" md-no-cache="true" md-selected-item="vm.receiveDevice.Location" md-search-text="vm.receiveDevice.search.locationQuery"
						md-items="location in vm.searchLocations(vm.receiveDevice.search.locationQuery)" md-item-text="location.name" md-floating-label="Search Location"
						data-ng-readonly="!$state.includes('editreceivedevice')">
						<md-item-template>
							<span md-highlight-text="vm.receiveDevice.search.locationQuery">{{location.name}}</span>
						</md-item-template>
						<md-not-found>
							No locations found.
						</md-not-found>
					</md-autocomplete>
				</div>
			</div>
			<div layout="row">
				<div flex="5">
					<md-icon style="color: orangered; margin-top: 25px;">event_note</md-icon>
				</div>
				<div flex="25">
					<md-input-container class="md-block">
						<label>Sticker No</label>
						<input name="stickerNo" ng-model="vm.receiveDevice.stickerNo" required data-ng-readonly="!$state.includes('editreceivedevice')"
						/>
					</md-input-container>
				</div>
				<div flex="5">
					<!-- Spacer //-->
				</div>
				<div flex="20">
					<md-input-container class="md-block">
						<label>Serial No</label>
						<input name="serialNo" ng-model="vm.receiveDevice.serialNo" data-ng-readonly="!$state.includes('editreceivedevice')" />
					</md-input-container>
				</div>
				<div flex="5">
					<!-- Spacer //-->
				</div>
			</div>
			<div layout="row">
				<div flex="5">
					<md-icon style="color: green; margin-top: 25px;">speaker_notes</md-icon>
				</div>
				<div flex="25">
					<md-input-container class="md-block">
						<label>Form No</label>
						<input name="formNo" ng-model="vm.receiveDevice.formNo" data-ng-readonly="!$state.includes('editreceivedevice')" />
					</md-input-container>
				</div>
				<div flex="5">
					<!-- Spacer //-->
				</div>
				<div flex="20">
					<md-input-container class="md-block">
						<label>Receive Date</label>
						<md-datepicker data-ng-model="vm.receiveDevice.receiveDate" data-ng-disabled="!$state.includes('editreceivedevice')"></md-datepicker>
					</md-input-container>
				</div>
				<div flex="20">
					<md-input-container class="md-block">
						<label>Handover Date</label>
						<md-datepicker data-ng-model="vm.receiveDevice.handoverDate" data-ng-disabled="!$state.includes('editreceivedevice')"></md-datepicker>
					</md-input-container>
				</div>
			</div>
			<div layout="row">
				<div flex="5">
					<md-icon style="color: coral; margin-top: 25px;">person</md-icon>
				</div>
				<div flex="25">
					<md-autocomplete md-input-minlength="2" md-no-cache="true" md-selected-item="vm.receiveDevice.HardwareEmployee" md-search-text="vm.receiveDevice.search.hardwareEmployeeQuery"
						md-items="hardwareEmployee in vm.searchEmployees(vm.receiveDevice.search.hardwareEmployeeQuery, 'Hardware')" md-item-text="hardwareEmployee.name"
						md-floating-label="Hardware Employee" data-ng-readonly="!$state.includes('editreceivedevice')">
						<md-item-template>
							<span md-highlight-text="vm.receiveDevice.search.hardwareEmployeeQuery">{{hardwareEmployee.name}}</span>
						</md-item-template>
						<md-not-found>
							No employees found.
						</md-not-found>
					</md-autocomplete>
				</div>
				<div flex="5">
					<!-- Spacer //-->
				</div>
				<div flex="25">
					<md-input-container>
						<label>Hardware Status</label>
						<md-select ng-model="vm.receiveDevice.HardwareStatusId" style="width: 220px;" data-ng-disabled="!$state.includes('editreceivedevice')">
							<md-option ng-repeat="hardwareStatus in vm.lookups.statuses" value="{{hardwareStatus.id}}">
								{{hardwareStatus.name}}
							</md-option>
						</md-select>
					</md-input-container>
				</div>
			</div>
			<div layout="row">
				<div flex="5">
					<md-icon style="color: indigo; margin-top: 25px;">person</md-icon>
				</div>
				<div flex="25">
					<md-autocomplete md-input-minlength="2" md-no-cache="true" md-selected-item="vm.receiveDevice.SoftwareEmployee" md-search-text="vm.receiveDevice.search.softwareEmployeeQuery"
						md-items="softwareEmployee in vm.searchEmployees(vm.receiveDevice.search.softwareEmployeeQuery, 'Software')" md-item-text="softwareEmployee.name"
						md-floating-label="Software Employee" data-ng-readonly="!$state.includes('editreceivedevice')">
						<md-item-template>
							<span md-highlight-text="vm.receiveDevice.search.softwareEmployeeQuery">{{softwareEmployee.name}}</span>
						</md-item-template>
						<md-not-found>
							No employees found.
						</md-not-found>
					</md-autocomplete>
				</div>
				<div flex="5">
					<!-- Spacer //-->
				</div>
				<div flex="25">
					<md-input-container>
						<label>Software Status</label>
						<md-select ng-model="vm.receiveDevice.SoftwareStatusId" style="width: 220px;" data-ng-disabled="!$state.includes('editreceivedevice')">
							<md-option ng-repeat="softwareStatus in vm.lookups.statuses" value="{{softwareStatus.id}}">
								{{softwareStatus.name}}
							</md-option>
						</md-select>
					</md-input-container>
				</div>
			</div>
			<div layout="row">
				<div flex="5">
					<md-icon class="md-primary" style="margin-top: 20px;">widgets</md-icon>
				</div>
				<div flex="80">
					<md-chips ng-model="vm.receiveDevice.ReceiveDeviceAccessories" md-autocomplete-snap md-require-match="true" data-ng-disabled="!$state.includes('editreceivedevice')">
						<md-autocomplete md-selected-item="selectedAccessory" md-search-text="vm.receiveDevice.search.searchAccessory" md-items="accessory in vm.searchAccessories(vm.receiveDevice.search.searchAccessory)"
							md-item-text="accessory.name" placeholder="Accessories" data-ng-readonly="!$state.includes('editreceivedevice')">
							<md-item-template>
								<span md-highlight-text="vm.receiveDevice.search.searchAccessory">{{accessory.name}}</span>
							</md-item-template>
						</md-autocomplete>
						<md-chip-template>
							<span>{{$chip.name}}</span>
						</md-chip-template>
					</md-chips>
				</div>
			</div>
			<div layout="row">
				<div flex="5">
					<md-icon style="color:red; margin-top: 20px;">devices</md-icon>
				</div>
				<div flex="80">
					<md-chips ng-model="vm.receiveDevice.ReceiveDeviceMissingDevices" md-autocomplete-snap md-require-match="true" data-ng-disabled="!$state.includes('editreceivedevice')">
						<md-autocomplete md-selected-item="selectedMissingDevice" md-search-text="vm.receiveDevice.search.searchMissingDevice" md-items="missingDevice in vm.searchMissingDevices(vm.receiveDevice.search.searchMissingDevice)"
							md-item-text="missingDevice.name" placeholder="Missing Devices" data-ng-readonly="!$state.includes('editreceivedevice')">
							<md-item-template>
								<span md-highlight-text="vm.receiveDevice.search.searchMissingDevice">{{missingDevice.name}}</span>
							</md-item-template>
						</md-autocomplete>
						<md-chip-template>
							<span>{{$chip.name}}</span>
						</md-chip-template>
					</md-chips>
				</div>
			</div>
		</form>
		<div layout="row" style="margin-top: 20px;">
			<div class="md-title"><span><md-icon class="md-warn">report_problem</md-icon> Customer Device Problems</span></div>
		</div>
		<hr class="hr-bottom">
		<div layout="row">
			<div flex="90">
				<md-list-item class="md-body-2" style="font-weight: bold;">
					<p class="deviceproblem-list-title">
						<md-button class="md-fab md-mini md-primary" data-ng-click="vm.addEditReceiveDeviceProblem($event)" data-ng-if="$state.includes('editreceivedevice')">
							<md-icon>add_circle_outline</md-icon>
							<md-tooltip md-direction="top">New Device Problem</md-tooltip>
						</md-button>
						Problem</p>
					<p class="deviceproblem-list-title">Detail</p>
					<p class="deviceproblem-list-title">Cost</p>
					<p class="deviceproblem-list-title">Service Charges</p>
					<p class="deviceproblem-list-title">Total</p>
					<p data-ng-if="$state.includes('editreceivedevice')">Actions</p>
				</md-list-item>
				<md-divider></md-divider>
				<md-list-item ng-repeat="problem in vm.receiveDevice.ReceiveDeviceProblems" class="md-body-1">
					<p class="deviceproblem-list-item">{{::problem.DeviceProblem.name}}</p>
					<p class="deviceproblem-list-item">{{::problem.detail}}</p>
					<p class="deviceproblem-list-item">{{::problem.cost}}</p>
					<p class="deviceproblem-list-item">{{::problem.serviceCharges}}</p>
					<p class="deviceproblem-list-item">{{::+problem.cost + +problem.serviceCharges}}</p>
					<p class="deviceproblem-list-item action-buttons" data-ng-if="$state.includes('editreceivedevice')">
						<md-button class="md-fab md-mini md-primary" data-ng-click="vm.addEditReceiveDeviceProblem($event, $index + 1)">
							<md-icon>edit</md-icon>
							<md-tooltip md-direction="top">Edit</md-tooltip>
						</md-button>
						<md-button class="md-fab md-mini md-warn md-hue-2" data-ng-click="vm.removeReceiveDeviceProblem($event, problem)">
							<md-icon>delete</md-icon>
							<md-tooltip md-direction="top">Delete</md-tooltip>
						</md-button>
					</p>
				</md-list-item>
				<md-divider></md-divider>
				<md-list-item class="md-body-1" data-ng-if="vm.receiveDevice.approvedTotal">
					<p class="deviceproblem-list-item">&nbsp;</p>
					<p class="deviceproblem-list-item">&nbsp;</p>
                    <p class="deviceproblem-list-item"><strong> Approved Total:&nbsp; <md-input-container><input name="approvedTotal" ng-model="vm.receiveDevice.approvedTotal" style="text-align:center;" data-ng-disabled="true"/></md-input-container><strong></p>
                    <p class="deviceproblem-list-item">&nbsp;</p>
                    <p class="deviceproblem-list-item">&nbsp;</p>
                    <p class="deviceproblem-list-item action-buttons">
                     &nbsp;
                    </p>
                </md-list-item>                
            </div>
        </div>
        <div data-ng-if="$state.includes('editcommunication') || $state.includes('editfixing')">
            <div layout="row" style="margin-top: 20px;">
                <div class="md-title"><span><md-icon class="md-primary">report_problem</md-icon>Employee Device Problems</span></div>
            </div>
            <hr class="hr-bottom">
            <div layout="row">
                <div flex="90">
                    <md-list-item class="md-body-2" style="font-weight: bold;">
                        <p class="deviceproblem-list-title">
                            <md-button class="md-fab md-mini md-primary" data-ng-click="vm.addEditReceiveDeviceProblem($event, null, true)" data-ng-if="$state.includes('editfixing')">
                                <md-icon>add_circle_outline</md-icon>
                                <md-tooltip md-direction="top">New Employee Device Problem</md-tooltip>
                            </md-button>
                            Problem</p>
                        <p class="deviceproblem-list-title">Detail</p>
                        <p class="deviceproblem-list-title">Cost</p>
                        <p class="deviceproblem-list-title">Service Charges</p>
                        <p data-ng-if="$state.includes('editfixing')">Actions</p>
                    </md-list-item>
                    <md-divider></md-divider>
                    <md-list-item ng-repeat="problem in vm.receiveDevice.ReceiveDeviceEmployeeProblems" class="md-body-1">
                        <p class="deviceproblem-list-item">{{::problem.DeviceProblem.name}}</p>
                        <p class="deviceproblem-list-item">{{::problem.detail}}</p>
                        <p class="deviceproblem-list-item">{{::problem.cost}}</p>
                        <p class="deviceproblem-list-item">{{::problem.serviceCharges}}</p>
                        <p class="deviceproblem-list-item action-buttons" data-ng-if="$state.includes('editfixing')">
                            <md-button class="md-fab md-mini md-primary" data-ng-click="vm.addEditReceiveDeviceProblem($event, $index + 1, true)">
                                <md-icon>edit</md-icon>
                                <md-tooltip md-direction="top">Edit</md-tooltip>
                            </md-button>
                            <md-button class="md-fab md-mini md-warn md-hue-2" data-ng-click="vm.removeReceiveDeviceProblem($event, problem, true)">
                                <md-icon>delete</md-icon>
                                <md-tooltip md-direction="top">Delete</md-tooltip>
                            </md-button>
                        </p>
                        <md-divider></md-divider>
                    </md-list-item>
                </div>
            </div>
        </div>
        <div data-ng-if="$state.includes('editcommunication')">
            <div layout="row" style="margin-top: 20px;">
                <div class="md-title"><span><md-icon class="md-warn">phone</md-icon>Customer Communications</span></div>
            </div>
            <hr class="hr-bottom">
            <div layout="row">
                <div flex="90">
                    <md-list-item class="md-body-2" style="font-weight: bold;">
                        <p class="deviceproblem-list-title">
                            <md-button class="md-fab md-mini md-primary" data-ng-click="vm.addEditCustomerCommunication($event, null)">
                                <md-icon>add_circle_outline</md-icon>
                                <md-tooltip md-direction="top">New Customer Communication</md-tooltip>
                            </md-button>
                            Phone No</p>
                        <p class="deviceproblem-list-title">Date
                            <e/p>
                                <p class="deviceproblem-list-title">Time</p>
                                <p class="deviceproblem-list-title">Details</p>
                                <p>Actions</p>
                    </md-list-item>
                    <md-divider></md-divider>
                    <md-list-item ng-repeat="communication in vm.receiveDevice.ReceiveDeviceCommunications" class="md-body-1">
                        <p class="deviceproblem-list-item">{{::communication.phoneNo}}</p>
                        <p class="deviceproblem-list-item">{{::communication.communicationDate | date:'dd/MM/yyyy' || ' '}}</p>
                        <p class="deviceproblem-list-item">{{::communication.communcationTime | date:'hh:mm a' || ' '}}</p>
                        <p class="deviceproblem-list-item">{{::communication.details}}</p>
                        <p class="deviceproblem-list-item action-buttons">
                            <md-button class="md-fab md-mini md-primary" data-ng-click="vm.addEditCustomerCommunication($event, $index + 1)">
                                <md-icon>edit</md-icon>
                                <md-tooltip md-direction="top">Edit</md-tooltip>
                            </md-button>
                            <md-button class="md-fab md-mini md-warn md-hue-2" data-ng-click="vm.removeCustomerCommunication($event, communication, true)">
                                <md-icon>delete</md-icon>
                                <md-tooltip md-direction="top">Delete</md-tooltip>
                            </md-button>
                        </p>
                        <md-divider></md-divider>
                    </md-list-item>
                </div>
            </div>
        </div>
        <div data-ng-if="$state.includes('editfixing')">
            <md-button data-ng-click="vm.fixingAction($event)">
                <md-icon class="green-button">eject</md-icon>
                Action
            </md-button>
        </div>
    </div>
</div>
<div layout="row">
    <span flex></span>
    <md-button>
        <md-icon class="green-button">arrow_back</md-icon>
        Back
    </md-button>
    <md-button data-ng-click="vm.getReceiveDevice()">
        <md-icon class="md-warn">cancel</md-icon>
        Cancel
    </md-button>
    <md-button class="md-primary" data-ng-click="vm.updateReceiveDevice()">
        <md-icon>save</md-icon>
        Update
    </md-button>
</div>
</div>